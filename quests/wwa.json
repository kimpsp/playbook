{
  "version": "1.2",
  "title": "Зомби апокалипсис: Последний выстрел",
  "author": "K1mps",
  "description": "Вы проснулись в заброшенной аптеке после биокатастрофы. Город мёртв, но вы живы. Ваша цель — выжить и найти убежище.",
  "tags": ["выживание", "хоррор", "зомби", "квест"],
  "default_image": "img/default_zombie.webp",
  "default_music": "sands/zombie_theme.mp3",
  "music": "sounds/zombie_ambience.mp3",
  "startNode": "start",

  "inventory": [
    {
      "id": "medkit",
      "name": "Аптечка",
      "description": "Восстанавливает здоровье на 50 единиц."
    },
    {
      "id": "pistol",
      "name": "Пистолет",
      "description": "3 патрона. Защита от зомби."
    },
    {
      "id": "note",
      "name": "Записка",
      "description": "'Беги в университет. Там безопасно.'"
    },
    {
      "id": "radio",
      "name": "Рация",
      "description": "Может передавать сигнал бедствия."
    }
  ],

  "states": {
    "helped_injured": false,
    "used_radio": false,
    "found_university": false,
    "health": 100
  },

  "nodes": {
    "start": {
      "image": "img/start_apocalypse.webp",
      "text": "Ты просыпаешься в заброшенной аптеке. За окнами — мёртвый город. Крики, стоны, треск радио. На столе — аптечка, пистолет с тремя патронами и записка: 'Беги в университет. Там безопасно.'",
      "choices": [
        {
          "text": "Взять всё и отправиться в университет",
          "next": "go_to_university",
          "actions": [
            { "type": "add_inventory", "item": "medkit" },
            { "type": "add_inventory", "item": "pistol" },
            { "type": "add_inventory", "item": "note" }
          ]
        },
        {
          "text": "Остаться и укрепить вход",
          "next": "barricade_door"
        }
      ]
    },

    "go_to_university": {
      "image": "img/city_ruins.webp",
      "text": "Ты выходишь на улицу. Ветер гонит пыль и обрывки бумаг. Вдали виднеется силуэт университета. По пути ты слышишь стон за углом — раненый человек лежит у машины.",
      "choices": [
        {
          "text": "Помочь ему",
          "next": "help_injured",
          "actions": [
            { "type": "set_state", "state": "helped_injured", "value": true }
          ]
        },
        {
          "text": "Пройти мимо — нельзя рисковать",
          "next": "ignore_injured"
        }
      ]
    },

    "help_injured": {
      "image": "img/injured_helped.webp",
      "text": "Ты подходишь. Мужчина смотрит на тебя глазами, полными боли. 'Спаси меня... Я знаю, где лекарство.' Ты помогаешь ему подняться. Он благодарен. Вместе вы дошли до университета. Там — группа учёных. Они работают над вакциной. И ты — теперь часть команды.",
      "choices": [
        {
          "text": "Начать новую жизнь среди выживших",
          "next": "good_ending"
        }
      ]
    },

    "ignore_injured": {
      "image": "img/ignored_injured.webp",
      "text": "Ты идёшь дальше. Но чувство вины не отпускает. У университета тебя встречает вооружённая группа. 'Ты один? Никого не спас? Мы не принимаем таких, кто бросает своих.' Двери захлопываются. Ты остаёшься снаружи. Ночь. И звуки приближающейся орды...",
      "choices": [
        {
          "text": "Попробовать пробиться внутрь",
          "next": "try_to_enter",
          "conditions": [
            { "type": "check_inventory", "item": "pistol", "value": true }
          ]
        },
        {
          "text": "Уйти в темноту",
          "next": "bad_ending"
        }
      ]
    },

    "try_to_enter": {
      "image": "img/fight_at_gate.webp",
      "text": "Ты стреляешь в воздух, привлекая внимание. Один из стражей поворачивается. 'Ты ещё можешь искупить вину,' — говорит он. Дверь открывается. Ты в безопасности.",
      "choices": [
        {
          "text": "Войти и начать помогать",
          "next": "good_ending"
        }
      ]
    },

    "barricade_door": {
      "image": "img/barricade.webp",
      "text": "Ты затаскиваешь полки и ящики к двери. Шум привлекает внимание. Снаружи что-то скребётся. Радио вдруг оживает: 'Если кто слышит — бегите на вокзал. Последний поезд уходит сегодня в 20:00.' У тебя ещё есть время.",
      "choices": [
        {
          "text": "Выбраться через окно и бежать на вокзал",
          "next": "train_station"
        },
        {
          "text": "Остаться — это ловушка",
          "next": "stay_and_die"
        }
      ]
    },

    "train_station": {
      "image": "img/train_station.webp",
      "text": "Ты добираешься до вокзала. Платформа пуста. Поезд стоит, двери открыты. Внутри — ни души. Ты заходишь. Двери закрываются. Поезд трогается. Но в последний момент ты замечаешь: за окном станции — сотни людей, машущих руками. Ты мог их спасти. Теперь ты уезжаешь один.",
      "choices": [
        {
          "text": "Остаться человеком — или просто выжить?",
          "next": "bad_ending"
        }
      ]
    },

    "stay_and_die": {
      "image": "img/death_in_pharmacy.webp",
      "text": "Ты решаешь остаться. Скребущие звуки усиливаются. Полки сдвигаются. Темнота. Последнее, что ты слышишь — чавкающие звуки. Аптека больше не укрытие. Она становится твоей могилой.",
      "choices": [
        {
          "text": "Начать заново",
          "next": "start"
        }
      ]
    },

    "good_ending": {
      "image": "img/good_ending.webp",
      "music": "sounds/hopeful_theme.mp3",
      "text": "Ты выбрал путь человечности. В университете тебя приняли. Вакцина будет готова. Ты — часть будущего. Люди снова могут надеяться.",
      "choices": [
        {
          "text": "Начать заново",
          "next": "start"
        }
      ]
    },

    "bad_ending": {
      "image": "img/bad_ending.webp",
      "music": "sounds/sad_theme.mp3",
      "text": "Ты выжил. Но цена слишком высока. Ты бросил других. Один в ночи, ты слышишь только стоны мёртвых... и своё сердце, замолкающее в одиночестве.",
      "choices": [
        {
          "text": "Начать заново",
          "next": "start"
        }
      ]
    }
  }
}
